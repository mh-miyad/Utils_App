<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loan Calculator</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            transition: background-color 0.3s;
        }
        body.light-mode {
            background-color: #fff;
            color: #2f2f2f;
        }
        body.dark-mode {
            background-color: #2f2f2f;
            color: #fff;
        }
        .container {
            max-width: 400px;
            margin: 50px auto;
            padding: 20px;
            background-color: #333;
            border: 1px solid #444;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
        }
        body.dark-mode .container {
            background-color: #333;
            border-color: #444;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        body.light-mode .container {
            background-color: #f0f0f0;
            border-color: #ddd;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        }
        label {
            display: block;
            margin-bottom: 10px;
        }
        input[type="number"] {
            width: 100%;
            height: 40px;
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #555;
            border-radius: 5px;
            background-color: #333;
            color: #fff;
            transition: background-color 0.3s, border-color 0.3s, color 0.3s;
        }
        body.light-mode input[type="number"] {
            background-color: #f0f0f0;
            border-color: #ddd;
            color: #2f2f2f;
        }
        select {
            width: 100%;
            height: 40px;
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #555;
            border-radius: 5px;
            background-color: #333;
            color: #fff;
            transition: background-color 0.3s, border-color 0.3s, color 0.3s;
        }
        body.light-mode select {
            background-color: #f0f0f0;
            border-color: #ddd;
            color: #2f2f2f;
        }
        button[type="button"] {
            width: 100%;
            height: 40px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button[type="button"]:hover {
            background-color: #0069d9;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: #333;
            padding: 20px;
            border: 1px solid #444;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            width: 300px;
            animation: modal-anim 0.5s;
            transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
        }
        body.light-mode .modal-content {
            background-color: #f0f0f0;
            border-color: #ddd;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        }
        @keyframes modal-anim {
            0% {
                transform: scale(0);
            }
            100% {
                transform: scale(1);
            }
        }
        .history-table {
            width: 100%;
            margin-top: 20px;
        }
        .history-table th, .history-table td {
            padding: 10px;
            border-bottom: 1px solid #555;
            transition: border-color 0.3s, background-color 0.3s, color 0.3s;
        }
        .history-table th {
            background-color: #444;
        }
        .history-table td {
            background-color: #333;
        }
        body.light-mode .history-table th {
            background-color: #ddd;
        }
        body.light-mode .history-table td {
            background-color: #f0f0f0;
        }
        .theme-toggle {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 24px;
            cursor: pointer;
        }
    </style>
</head>
<body class="dark-mode">
    <div class="container">
        <h2>Loan Calculator</h2>
        <i class="fa-solid fa-moon theme-toggle" id="theme-toggle"></i>
        <form id="loan-form">
            <label for="loan-amount">Loan Amount:</label>
            <input type="number" id="loan-amount" required>
            <label for="interest-rate">Interest Rate (%):</label>
            <input type="number" id="interest-rate" required>
            <label for="loan-term">Loan Term:</label>
            <input type="number" id="loan-term" required>
            <label for="loan-unit">Loan Term Unit:</label>
            <select id="loan-unit">
                <option value="year">Years</option>
                <option value="month">Months</option>
                <option value="week">Weeks</option>
            </select>
            <label for="currency">Currency:</label>
            <select id="currency">
                <option value="USD">USD ($)</option>
                <option value="BDT">BDT (৳)</option>
                <option value="INR">INR (₹)</option>
                <option value="GBP">GBP (£)</option>
                <option value="EUR">EUR (€)</option>
            </select>
            <button type="button" id="calculate-btn">Calculate</button>
        </form>
        <div class="history-table" id="history-table">
            <table>
                <tr>
                    <th>Date</th>
                    <th>Loan Amount</th>
                    <th>Interest Rate</th>
                    <th>Loan Term</th>
                    <th>Monthly Payment</th>
                    <th>Currency</th>
                </tr>
                <tbody id="history-body"></tbody>
            </table>
        </div>
    </div>
    <div id="modal" class="modal">
        <div class="modal-content">
            <p id="monthly-payment"></p>
            <button type="button" id="close-btn">Close</button>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const loanForm = document.getElementById('loan-form');
        const calculateBtn = document.getElementById('calculate-btn');
        const modal = document.getElementById('modal');
        const monthlyPaymentElement = document.getElementById('monthly-payment');
        const closeBtn = document.getElementById('close-btn');
        const historyBody = document.getElementById('history-body');
        const themeToggle = document.getElementById('theme-toggle');
        let history = [];
        let theme = 'dark';

        calculateBtn.addEventListener('click', calculateLoan);
        closeBtn.addEventListener('click', close_modal);
        themeToggle.addEventListener('click', toggleTheme);

        function calculateLoan() {
            const loanAmount = parseFloat(document.getElementById('loan-amount').value);
            const interestRate = parseFloat(document.getElementById('interest-rate').value) / 100;
            const loanTerm = parseFloat(document.getElementById('loan-term').value);
            const loanUnit = document.getElementById('loan-unit').value;
            const currency = document.getElementById('currency').value;

            let months;
            switch (loanUnit) {
                case 'year':
                    months = loanTerm * 12;
                    break;
                case 'month':
                    months = loanTerm;
                    break;
                case 'week':
                    months = loanTerm / 4;
                    break;
                default:
                    months = loanTerm * 12;
            }

            const monthlyInterestRate = interestRate / 12;
            const numerator = Math.pow((1 + monthlyInterestRate), months);
            const denominator = numerator - 1;
            const monthlyPayment = (loanAmount * monthlyInterestRate * numerator) / denominator;

            monthlyPaymentElement.textContent = `Monthly Payment: ${currency} ${monthlyPayment.toFixed(2)}`;
            saveHistory(loanAmount, interestRate, loanTerm, loanUnit, monthlyPayment, currency);
            modal.style.display = 'flex';
        }

        function saveHistory(loanAmount, interestRate, loanTerm, loanUnit, monthlyPayment, currency) {
            history.push({
                date: new Date().toLocaleString(),
                loanAmount,
                interestRate,
                loanTerm,
                loanUnit,
                monthlyPayment,
                currency
            });
            updateHistoryTable();
            localStorage.setItem('history', JSON.stringify(history));
        }

        function updateHistoryTable() {
            historyBody.innerHTML = '';
            history.forEach((item, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.date}</td>
                    <td>${item.currency} ${item.loanAmount.toLocaleString()}</td>
                    <td>${item.interestRate}%</td>
                    <td>${item.loanTerm} ${item.loanUnit}</td>
                    <td>${item.currency} ${item.monthlyPayment.toLocaleString()}</td>
                    <td>${item.currency}</td>
                `;
                historyBody.appendChild(row);
            });
        }

        function close_modal() {
            modal.style.display = 'none';
        }

        function toggleTheme() {
            if (theme === 'dark') {
                document.body.classList.remove('dark-mode');
                document.body.classList.add('light-mode');
                theme = 'light';
                themeToggle.className = 'fa-solid fa-sun theme-toggle';
                localStorage.setItem('theme', theme);
            } else {
                document.body.classList.remove('light-mode');
                document.body.classList.add('dark-mode');
                theme = 'dark';
                themeToggle.className = 'fa-solid fa-moon theme-toggle';
                localStorage.setItem('theme', theme);
            }
        }

        const storedHistory = localStorage.getItem('history');
        if (storedHistory) {
            history = JSON.parse(storedHistory);
            updateHistoryTable();
        }
        const storedTheme = localStorage.getItem('theme');
        if (storedTheme) {
            if (storedTheme === 'light') {
                document.body.classList.remove('dark-mode');
                document.body.classList.add('light-mode');
                theme = 'light';
                themeToggle.className = 'fa-solid fa-sun theme-toggle';
            } else {
                document.body.classList.remove('light-mode');
                document.body.classList.add('dark-mode');
                theme = 'dark';
                themeToggle.className = 'fa-solid fa-moon theme-toggle';
            }
        }
    </script>
</body>
</html>
